<!--
  ~ Copyright (c) 2025 Florian Hehlen & Ã“scar Otero
  ~ All rights reserved.
  -->

<idea-plugin>
    <id>org.js.vento.plugin</id>

    <name>Vento Template Engine</name>

    <description>Content replaced at build-time from README.md</description>
    <change-notes>Content replaced at build time from CHANGELOG.md</change-notes>

    <vendor url="https://github.com/ventojs">ventojs</vendor>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.json</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.xml</depends>
    <depends>JavaScript</depends>

    <extensions defaultExtensionNs="com.intellij">

        <projectConfigurable
                parentId="language"
                instance="org.js.vento.plugin.settings.SettingsConfigurable"
                id="org.js.vento.plugin.settings.SettingsConfigurable"
                displayName="Vento"/>
        <!-- Settings is annotated with @Service, no explicit registration needed here -->
        <postStartupActivity implementation="org.js.vento.plugin.settings.SettingsStartupActivity"/>

        <fileType name="Vento File" implementationClass="org.js.vento.plugin.file.VentoFileType" fieldName="INSTANCE" language="Vento" extensions="vto"/>
        <html.scriptContentProvider language="Vento" implementationClass="org.js.vento.plugin.highlighting.ScriptContentProvider"/>
        <lang.fileViewProviderFactory language="Vento" implementationClass="org.js.vento.plugin.file.ViewProviderFactory"/>
        <lang.parserDefinition language="Vento" implementationClass="org.js.vento.plugin.VentoParserDefinition"/>
        <lang.syntaxHighlighter language="Vento" implementationClass="org.js.vento.plugin.highlighting.SyntaxHighlighter"/>
        <editorHighlighterProvider filetype="Vento File" implementationClass="org.js.vento.plugin.highlighting.HighlighterProvider"/>
        <colorSettingsPage implementation="org.js.vento.plugin.highlighting.ColorSettingsPage"/>
        <annotator language="Vento" implementationClass="org.js.vento.plugin.highlighting.Annotator"/>
        <lang.psiStructureViewFactory language="Vento" implementationClass="org.js.vento.plugin.structure.StructureViewFactory"/>
        <lang.ast.factory language="Vento" implementationClass="org.js.vento.plugin.lexer.AstFactory"/>
        <multiHostInjector implementation="org.js.vento.plugin.parser.injectors.ContextualJavaScriptInjector"/>

        <!-- Editor features -->
        <typedHandler implementation="org.js.vento.plugin.editor.VentoTypedHandler"/>
        <completion.contributor language="Vento" implementationClass="org.js.vento.plugin.editor.CompletionContributor"/>
        <completion.contributor language="JavaScript" implementationClass="org.js.vento.plugin.editor.CompletionContributor"/>
        <completion.contributor language="HTML" implementationClass="org.js.vento.plugin.editor.CompletionContributor"/>
        <lang.braceMatcher language="Vento" implementationClass="org.js.vento.plugin.editor.VentoBraceMatcher"/>
        <lookup.charFilter implementation="org.js.vento.plugin.editor.VentoCharFilter"/>
        <lang.formatter language="Vento" implementationClass="org.js.vento.plugin.formatting.VentoFormattingModelBuilder"/>

    </extensions>

    <actions>
        <action id="VentoToggleCommentAction"
                class="org.js.vento.plugin.actions.ToggleCommentAction"
                text="Toggle Vento Comment"
                description="Toggle Vento comment markers ({{# #}}) around selection">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl SLASH"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta SLASH"/>
            <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="meta SLASH"/>
        </action>
    </actions>
</idea-plugin>
